{% extends "base.html" %}

{% block content %}
<div class="glass-container" style="max-width: 600px; margin: 2rem auto;">
    <h2>Edit Expense</h2>
    <p style="margin-bottom: 20px; color: #666;">Modify the expense details and update who it's split with.</p>
    <form action="{{ url_for('edit_expense', expense_id=expense.id) }}" method="POST">
        <div class="input-group">
            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Description</label>
            <input type="text" name="description" value="{{ expense.description }}" required autofocus>
        </div>
        <div class="input-group">
            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Total Amount (PKR)</label>
            <input type="number" step="0.01" name="amount" value="{{ expense.amount }}" required>
        </div>

        <div class="input-group">
            <label style="display: block; margin-bottom: 1rem; font-weight: 600;">Split with:</label>
            <div
                style="max-height: 300px; overflow-y: auto; background: rgba(255,255,255,0.3); padding: 1rem; border-radius: 8px;">
                {% if users %}
                {% for user in users %}
                <div class="checkbox-item" style="margin-bottom: 0.8rem;">
                    <label style="display: flex; align-items: center; cursor: pointer;">
                        <input type="checkbox" name="selected_users" value="{{ user.id }}" {% if user.id in
                            current_users %}checked{% endif %}
                            style="width: auto; margin-right: 0.8rem; cursor: pointer;">
                        <span style="font-size: 1rem;">{{ user.username }}</span>
                        {% if user.id == expense.payer_id %}
                        <span style="margin-left: 0.5rem; color: #2575fc; font-size: 0.9rem;">(Payer)</span>
                        {% endif %}
                    </label>
                </div>
                {% endfor %}
                {% else %}
                <p style="color: #999; text-align: center;">No users available.</p>
                {% endif %}
            </div>
        </div>

        <div style="display: flex; gap: 1rem; margin-top: 1rem;">
            <button type="submit" class="btn" style="flex: 1;">Update Expense</button>
            <a href="{{ url_for('history') }}" class="btn"
                style="flex: 1; background: linear-gradient(90deg, #95a5a6, #7f8c8d); text-align: center; text-decoration: none; display: flex; align-items: center; justify-content: center;">Cancel</a>
        </div>
    </form>
</div>
{% endblock %}